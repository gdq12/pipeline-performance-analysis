{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.3", "generated_at": "2025-03-26T17:39:14.124705Z", "invocation_id": "54a06605-cbf6-490a-9354-bf1598aec10a", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-26T17:35:31.734923Z", "completed_at": "2025-03-26T17:35:31.756676Z"}, {"name": "execute", "started_at": "2025-03-26T17:35:31.758791Z", "completed_at": "2025-03-26T17:35:32.803937Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0734529495239258, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "pipeline-analysis-452722", "job_id": "3a7c2c2b-f9fd-4780-8908-3a08a0210cf6", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.pipeline_analysis_transform.yellow__1_column_name_mapping", "compiled": true, "compiled_code": "select \n  table_name\n  , column_name old_column_name\n  , case\n      when column_name in ('start_lon', 'pickup_longitude') then 'pickup_longitude'\n      when column_name in ('start_lat', 'pickup_latitude') then 'pickup_latitude'\n      when column_name in ('end_lon', 'dropoff_longitude') then 'dropoff_longitude'\n      when column_name in ('end_lat', 'dropoff_latitude') then 'dropoff_latitude'\n      when column_name = 'store_and_forward' then 'store_and_fwd_flag'\n      when column_name = 'vendor_name' then 'vendor_id'\n      when column_name = 'rate_code' then 'ratecode_id'\n      when column_name = 'extra' then 'extra_amount'\n      when column_name = 'surcharge' then 'congestion_surcharge'\n      when regexp_substr(column_name, 'do_') is not null then regexp_replace(column_name, 'do_', 'dropoff_')\n      when regexp_substr(column_name, 'pu_') is not null then regexp_replace(column_name, 'pu_', 'pickup_')\n      when regexp_substr(column_name, 'amt') is not null then regexp_replace(column_name, 'amt', 'amount')\n      when regexp_substr(column_name, 'tpep') is not null then regexp_replace(column_name, 'tpep_', '')\n      when regexp_substr(column_name, 'trip_') is not null \n        and regexp_substr(column_name, 'date') is not null \n        then regexp_replace(regexp_replace(column_name, 'trip_', ''), 'date_time$', 'datetime')\n      else column_name end new_column_name\n  , data_type\n  , ordinal_position\nfrom `pipeline-analysis-452722`.`nytaxi_stage`.`INFORMATION_SCHEMA.COLUMNS`\nwhere column_name != '__index_level_0__'\nand regexp_substr(table_name, 'yellow_tripdata') is not null", "relation_name": "`pipeline-analysis-452722`.`nytaxi_clean`.`yellow__1_column_name_mapping`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-26T17:35:32.841614Z", "completed_at": "2025-03-26T17:35:38.989043Z"}, {"name": "execute", "started_at": "2025-03-26T17:35:38.990731Z", "completed_at": "2025-03-26T17:35:39.666779Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 6.844238519668579, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "pipeline-analysis-452722", "job_id": "c69fe161-ece2-4a9d-9486-191c256d366c", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.pipeline_analysis_transform.yellow__2a_2009_2010_tbl_collation", "compiled": true, "compiled_code": "with trps as \n(\n\n\n\n\n\n  \n\n  \n\n  select \n    \n          \n            surcharge as congestion_surcharge\n          \n        , \n          \n            creation_dt as creation_dt\n          \n        , \n          \n            data_source as data_source\n          \n        , \n          \n            trip_dropoff_date_time as dropoff_datetime\n          \n        , \n          \n            end_lat as dropoff_latitude\n          \n        , \n          \n            end_lon as dropoff_longitude\n          \n        , \n          \n            fare_amt as fare_amount\n          \n        , \n          \n            mta_tax as mta_tax\n          \n        , \n          \n            passenger_count as passenger_count\n          \n        , \n          \n            payment_type as payment_type\n          \n        , \n          \n            trip_pickup_date as pickup_date\n          \n        , \n          \n            trip_pickup_date_time as pickup_datetime\n          \n        , \n          \n            start_lat as pickup_latitude\n          \n        , \n          \n            start_lon as pickup_longitude\n          \n        , \n          \n            safe_cast(rate_code as INT64) as ratecode_id\n          \n        , \n          \n            safe_cast(store_and_forward as string) as store_and_fwd_flag\n          \n        , \n          \n            tip_amt as tip_amount\n          \n        , \n          \n            tolls_amt as tolls_amount\n          \n        , \n          \n            total_amt as total_amount\n          \n        , \n          \n            trip_distance as trip_distance\n          \n        , \n          \n            vendor_name as vendor_id\n          \n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2009-01`\n    union all \n\n  \n\n  \n\n  select \n    \n          \n            surcharge as congestion_surcharge\n          \n        , \n          \n            creation_dt as creation_dt\n          \n        , \n          \n            data_source as data_source\n          \n        , \n          \n            dropoff_datetime as dropoff_datetime\n          \n        , \n          \n            dropoff_latitude as dropoff_latitude\n          \n        , \n          \n            dropoff_longitude as dropoff_longitude\n          \n        , \n          \n            fare_amount as fare_amount\n          \n        , \n          \n            mta_tax as mta_tax\n          \n        , \n          \n            passenger_count as passenger_count\n          \n        , \n          \n            payment_type as payment_type\n          \n        , \n          \n            pickup_date as pickup_date\n          \n        , \n          \n            pickup_datetime as pickup_datetime\n          \n        , \n          \n            pickup_latitude as pickup_latitude\n          \n        , \n          \n            pickup_longitude as pickup_longitude\n          \n        , \n          \n            safe_cast(rate_code as INT64) as ratecode_id\n          \n        , \n          \n            safe_cast(store_and_fwd_flag as string) as store_and_fwd_flag\n          \n        , \n          \n            tip_amount as tip_amount\n          \n        , \n          \n            tolls_amount as tolls_amount\n          \n        , \n          \n            total_amount as total_amount\n          \n        , \n          \n            trip_distance as trip_distance\n          \n        , \n          \n            vendor_id as vendor_id\n          \n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2010-01`\n    union all \n\n  \n\n  \n\n  select \n    \n          \n            surcharge as congestion_surcharge\n          \n        , \n          \n            creation_dt as creation_dt\n          \n        , \n          \n            data_source as data_source\n          \n        , \n          \n            dropoff_datetime as dropoff_datetime\n          \n        , \n          \n            dropoff_latitude as dropoff_latitude\n          \n        , \n          \n            dropoff_longitude as dropoff_longitude\n          \n        , \n          \n            fare_amount as fare_amount\n          \n        , \n          \n            mta_tax as mta_tax\n          \n        , \n          \n            passenger_count as passenger_count\n          \n        , \n          \n            payment_type as payment_type\n          \n        , \n          \n            pickup_date as pickup_date\n          \n        , \n          \n            pickup_datetime as pickup_datetime\n          \n        , \n          \n            pickup_latitude as pickup_latitude\n          \n        , \n          \n            pickup_longitude as pickup_longitude\n          \n        , \n          \n            safe_cast(rate_code as INT64) as ratecode_id\n          \n        , \n          \n            safe_cast(store_and_fwd_flag as string) as store_and_fwd_flag\n          \n        , \n          \n            tip_amount as tip_amount\n          \n        , \n          \n            tolls_amount as tolls_amount\n          \n        , \n          \n            total_amount as total_amount\n          \n        , \n          \n            trip_distance as trip_distance\n          \n        , \n          \n            vendor_id as vendor_id\n          \n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2010-02`\n    union all \n\n  \n\n  \n\n  select \n    \n          \n            surcharge as congestion_surcharge\n          \n        , \n          \n            creation_dt as creation_dt\n          \n        , \n          \n            data_source as data_source\n          \n        , \n          \n            dropoff_datetime as dropoff_datetime\n          \n        , \n          \n            dropoff_latitude as dropoff_latitude\n          \n        , \n          \n            dropoff_longitude as dropoff_longitude\n          \n        , \n          \n            fare_amount as fare_amount\n          \n        , \n          \n            mta_tax as mta_tax\n          \n        , \n          \n            passenger_count as passenger_count\n          \n        , \n          \n            payment_type as payment_type\n          \n        , \n          \n            pickup_date as pickup_date\n          \n        , \n          \n            pickup_datetime as pickup_datetime\n          \n        , \n          \n            pickup_latitude as pickup_latitude\n          \n        , \n          \n            pickup_longitude as pickup_longitude\n          \n        , \n          \n            safe_cast(rate_code as INT64) as ratecode_id\n          \n        , \n          \n            safe_cast(store_and_fwd_flag as string) as store_and_fwd_flag\n          \n        , \n          \n            tip_amount as tip_amount\n          \n        , \n          \n            tolls_amount as tolls_amount\n          \n        , \n          \n            total_amount as total_amount\n          \n        , \n          \n            trip_distance as trip_distance\n          \n        , \n          \n            vendor_id as vendor_id\n          \n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2010-04`\n    \n)\nselect \n  vendor_id,\n  pickup_datetime,\n  dropoff_datetime,\n  passenger_count,\n  trip_distance,\n  pickup_longitude, \n  pickup_latitude,\n  ratecode_id,\n  store_and_fwd_flag,\n  dropoff_longitude, \n  dropoff_latitude,\n  payment_type,\n  fare_amount,\n  mta_tax,\n  tip_amount,\n  tolls_amount,\n  total_amount,\n  congestion_surcharge,\n  pickup_date,\n  data_source,\n  creation_dt\nfrom trps", "relation_name": "`pipeline-analysis-452722`.`nytaxi_clean`.`yellow__2a_2009_2010_tbl_collation`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-26T17:35:39.678234Z", "completed_at": "2025-03-26T17:35:39.686974Z"}, {"name": "execute", "started_at": "2025-03-26T17:35:39.688310Z", "completed_at": "2025-03-26T17:35:40.859222Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1836953163146973, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "pipeline-analysis-452722", "job_id": "d8cbee44-21fa-4d42-8261-6c3b350b70f5", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.pipeline_analysis_transform.yellow__2b_2009_2010_location_id_update", "compiled": true, "compiled_code": "select \n  trp.vendor_id,\n  trp.pickup_datetime,\n  trp.dropoff_datetime,\n  trp.passenger_count,\n  trp.trip_distance,\n  pu.zone_id pickup_location_id,\n  trp.ratecode_id,\n  trp.store_and_fwd_flag,\n  du.zone_id dropoff_location_id,\n  trp.payment_type,\n  trp.fare_amount,\n  trp.mta_tax,\n  trp.tip_amount,\n  trp.tolls_amount,\n  trp.total_amount,\n  trp.congestion_surcharge,\n  trp.pickup_date,\n  trp.data_source,\n  trp.creation_dt\nfrom `pipeline-analysis-452722`.`nytaxi_clean`.`yellow__2a_2009_2010_tbl_collation` trp\njoin `pipeline-analysis-452722`.`mapping`.`taxi_zone_geom` pu on (ST_DWithin(pu.zone_geom,ST_GeogPoint(trp.pickup_longitude, trp.pickup_latitude), 0))\njoin `pipeline-analysis-452722`.`mapping`.`taxi_zone_geom` du on (ST_DWithin(du.zone_geom,ST_GeogPoint(trp.dropoff_longitude, trp.dropoff_latitude), 0))\nwhere trp.pickup_longitude between -180 and 180\nand trp.pickup_latitude between -90 and 90\nand trp.dropoff_longitude between -180 and 180\nand trp.dropoff_latitude between -90 and 90", "relation_name": "`pipeline-analysis-452722`.`nytaxi_clean`.`yellow__2b_2009_2010_location_id_update`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-26T17:35:32.829483Z", "completed_at": "2025-03-26T17:36:01.897375Z"}, {"name": "execute", "started_at": "2025-03-26T17:36:01.898401Z", "completed_at": "2025-03-26T17:36:02.673335Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 29.853928089141846, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "pipeline-analysis-452722", "job_id": "9d443bc8-8fa5-4a7c-a1c3-310b2fec9645", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.pipeline_analysis_transform.yellow__2_post_2010_tbl_collation", "compiled": true, "compiled_code": "with trps as \n(\n\n\n\n\n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2011-01`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2011-02`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2011-03`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2011-04`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2012-12`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2013-01`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2013-05`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2013-06`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2014-01`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2014-02`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2014-08`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2014-09`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2018-01`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2018-02`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2018-06`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2018-07`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2018-09`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2018-10`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2018-11`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2018-12`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2019-01`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2020-08`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2020-10`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2020-11`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2023-02`\n    \n)\nselect \n  vendor_id,\n  pickup_datetime,\n  dropoff_datetime,\n  passenger_count,\n  trip_distance,\n  pickup_location_id,\n  ratecode_id,\n  store_and_fwd_flag,\n  dropoff_location_id,\n  payment_type,\n  fare_amount,\n  extra_amount,\n  mta_tax,\n  tip_amount,\n  tolls_amount,\n  improvement_surcharge,\n  total_amount,\n  congestion_surcharge,\n  airport_fee,\n  pickup_date,\n  data_source,\n  creation_dt\nfrom trps", "relation_name": "`pipeline-analysis-452722`.`nytaxi_clean`.`yellow__2_post_2010_tbl_collation`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-26T17:36:02.683628Z", "completed_at": "2025-03-26T17:36:02.755661Z"}, {"name": "execute", "started_at": "2025-03-26T17:36:02.774090Z", "completed_at": "2025-03-26T17:36:04.038186Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.3573696613311768, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "pipeline-analysis-452722", "job_id": "544ce568-52bb-41b7-819c-195fb6c96fb9", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.pipeline_analysis_transform.yellow__3_data_type_cast", "compiled": true, "compiled_code": "with trps as \n(select \n    case safe_cast(vendor_id as string)\n        when '1' then 1\n        when '2' then 2\n        when '3' then 3\n        when '4' then 4\n        when '5' then 5\n        when '6' then 6\n        when '7' then 7\n        when 'CMT' then 1\n        when 'VTS' then 8\n        when 'DDS' then 9\n        else null\n    end vendor_id\n    ,cast(pickup_datetime as timestamp) pickup_datetime \n    ,cast(dropoff_datetime as timestamp) dropoff_datetime\n    ,safe_cast(passenger_count as INT64) passenger_count\n    ,cast(trip_distance as float64) trip_distance\n    ,safe_cast(pickup_location_id as INT64) pickup_location_id\n    ,case safe_cast(ratecode_id as string)\n        when '1' then 1\n        when '1.0' then 1\n        when '2' then 2\n        when '2.0' then 2\n        when '3' then 3\n        when '3.0' then 3\n        when '4' then 4\n        when '4.0' then 4\n        when '5' then 5\n        when '5.0' then 5\n        when '6' then 6\n        when '6.0' then 6\n        else null\n    end ratecode_id\n    ,case \n        when trim(safe_cast(store_and_fwd_flag as string))\n            in ('0', '0.0', 'N') then 'N'\n        when trim(safe_cast(store_and_fwd_flag as string))\n            in ('1', '1.0', 'Y') then 'Y'\n        else null \n    end  store_and_fwd_flag\n    ,safe_cast(dropoff_location_id as INT64) dropoff_location_id\n    ,case \n        when lower(trim(safe_cast(payment_type as string))) \n            in ('cash', 'csh', 'cas') then 2\n        when lower(trim(safe_cast(payment_type as string))) \n            in ('credit', 'cre', 'crd') then 1\n        when lower(trim(safe_cast(payment_type as string))) \n            in ('dispute', 'dis') then 4\n        when lower(trim(safe_cast(payment_type as string)))\n            in ('no', 'no charge', 'noc') then 3\n        when lower(trim(safe_cast(payment_type as string)))\n            in ('na', '0') then 5\n        when lower(trim(safe_cast(payment_type as string)))\n            in ('6', '6.0', 'void', 'voi') then 6\n        else 5\n    end payment_type\n    ,cast(fare_amount as float64) fare_amount\n    ,cast(null as float64) extra_amount\n    ,cast(mta_tax as float64) mta_tax\n    ,cast(tip_amount as float64) tip_amount\n    ,cast(tolls_amount as float64) tolls_amount\n    ,cast(null as float64) improvement_surcharge\n    ,cast(total_amount as float64) total_amount\n    ,cast(congestion_surcharge as float64) congestion_surcharge\n    , cast(null as float64) airport_fee\n    ,cast(pickup_date as timestamp) pickup_date\n    ,safe_cast(data_source as string) data_source\n    ,cast(creation_dt as timestamp) creation_dt\nfrom `pipeline-analysis-452722`.`nytaxi_clean`.`yellow__2b_2009_2010_location_id_update`\nunion all \nselect \n    case safe_cast(vendor_id as string)\n        when '1' then 1\n        when '2' then 2\n        when '3' then 3\n        when '4' then 4\n        when '5' then 5\n        when '6' then 6\n        when '7' then 7\n        when 'CMT' then 1\n        when 'VTS' then 8\n        when 'DDS' then 9\n        else null\n    end vendor_id\n    ,cast(pickup_datetime as timestamp) pickup_datetime \n    ,cast(dropoff_datetime as timestamp) dropoff_datetime\n    ,safe_cast(passenger_count as INT64) passenger_count\n    ,cast(trip_distance as float64) trip_distance\n    ,safe_cast(pickup_location_id as INT64) pickup_location_id\n    ,case safe_cast(ratecode_id as string)\n        when '1' then 1\n        when '1.0' then 1\n        when '2' then 2\n        when '2.0' then 2\n        when '3' then 3\n        when '3.0' then 3\n        when '4' then 4\n        when '4.0' then 4\n        when '5' then 5\n        when '5.0' then 5\n        when '6' then 6\n        when '6.0' then 6\n        else null\n    end ratecode_id\n    ,case \n        when trim(safe_cast(store_and_fwd_flag as string))\n            in ('0', '0.0', 'N') then 'N'\n        when trim(safe_cast(store_and_fwd_flag as string))\n            in ('1', '1.0', 'Y') then 'Y'\n        else null \n    end  store_and_fwd_flag\n    ,safe_cast(dropoff_location_id as INT64) dropoff_location_id\n    ,case \n        when lower(trim(safe_cast(payment_type as string))) \n            in ('cash', 'csh', 'cas') then 2\n        when lower(trim(safe_cast(payment_type as string))) \n            in ('credit', 'cre', 'crd') then 1\n        when lower(trim(safe_cast(payment_type as string))) \n            in ('dispute', 'dis') then 4\n        when lower(trim(safe_cast(payment_type as string)))\n            in ('no', 'no charge', 'noc') then 3\n        when lower(trim(safe_cast(payment_type as string)))\n            in ('na', '0') then 5\n        when lower(trim(safe_cast(payment_type as string)))\n            in ('6', '6.0', 'void', 'voi') then 6\n        else 5\n    end payment_type\n    ,cast(fare_amount as float64) fare_amount\n    ,cast(extra_amount as float64) extra_amount\n    ,cast(mta_tax as float64) mta_tax\n    ,cast(tip_amount as float64) tip_amount\n    ,cast(tolls_amount as float64) tolls_amount\n    ,cast(improvement_surcharge as float64) improvement_surcharge\n    ,cast(total_amount as float64) total_amount\n    ,cast(congestion_surcharge as float64) congestion_surcharge\n    ,cast(airport_fee as float64) airport_fee\n    ,cast(pickup_date as timestamp) pickup_date\n    ,safe_cast(data_source as string) data_source\n    ,cast(creation_dt as timestamp) creation_dt\nfrom `pipeline-analysis-452722`.`nytaxi_clean`.`yellow__2_post_2010_tbl_collation`\n)\nselect \n  vendor_id,\n  pickup_datetime,\n  dropoff_datetime,\n  passenger_count,\n  trip_distance,\n  pickup_location_id,\n  ratecode_id,\n  store_and_fwd_flag,\n  dropoff_location_id,\n  payment_type,\n  fare_amount,\n  extra_amount,\n  mta_tax,\n  tip_amount,\n  tolls_amount,\n  improvement_surcharge,\n  total_amount,\n  congestion_surcharge,\n  airport_fee,\n  pickup_date,\n  data_source,\n  creation_dt\nfrom trps", "relation_name": "`pipeline-analysis-452722`.`nytaxi_clean`.`yellow__3_data_type_cast`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-26T17:36:04.048825Z", "completed_at": "2025-03-26T17:36:04.080602Z"}, {"name": "execute", "started_at": "2025-03-26T17:36:04.083025Z", "completed_at": "2025-03-26T17:36:05.229785Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1971900463104248, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "pipeline-analysis-452722", "job_id": "4640e49b-2df1-4805-8415-3866bee5ed22", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.pipeline_analysis_transform.yellow__4_adds_columns", "compiled": true, "compiled_code": "select \n  to_hex(md5(cast(coalesce(cast(vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(pickup_datetime  as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(passenger_count as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(trip_distance as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(pickup_location_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(ratecode_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_and_fwd_flag as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_location_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(payment_type as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(fare_amount as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(extra_amount as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(mta_tax as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tip_amount as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tolls_amount as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(improvement_surcharge as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(total_amount as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(congestion_surcharge as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(airport_fee as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data_source as string), '_dbt_utils_surrogate_key_null_') as string))) trip_id,\n  vendor_id,\n  pickup_datetime,\n  dropoff_datetime,\n  passenger_count,\n  trip_distance,\n  pickup_location_id,\n  ratecode_id,\n  store_and_fwd_flag,\n  dropoff_location_id,\n  payment_type,\n  fare_amount,\n  extra_amount,\n  mta_tax,\n  tip_amount,\n  tolls_amount,\n  improvement_surcharge,\n  total_amount,\n  congestion_surcharge,\n  airport_fee,\n  pickup_date,\n  regexp_replace(regexp_substr(data_source, '[a-z]{1,6}_tripdata'), '_tripdata', '') trip_type,\n  parse_datetime('%Y-%m-%d', regexp_substr(data_source, '[0-9]{4}-[0-9]{2}$')||'-01') trip_type_start_date,\n  cast(last_day(parse_date('%Y-%m-%d', regexp_substr(data_source, '[0-9]{4}-[0-9]{2}$')||'-01'), month) as timestamp) trip_type_end_date,\n  data_source,\n  creation_dt\nfrom `pipeline-analysis-452722`.`nytaxi_clean`.`yellow__3_data_type_cast`", "relation_name": "`pipeline-analysis-452722`.`nytaxi_clean`.`yellow__4_adds_columns`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-26T17:36:05.276427Z", "completed_at": "2025-03-26T17:36:05.296689Z"}, {"name": "execute", "started_at": "2025-03-26T17:36:05.299531Z", "completed_at": "2025-03-26T17:36:06.675491Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.410921573638916, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "pipeline-analysis-452722", "job_id": "4ab8ff9d-310b-43fe-a447-7da44855e87b", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.pipeline_analysis_transform.stg_yellow__1a_id_duplicate_records", "compiled": true, "compiled_code": "\n\nselect \n  pickup_datetime, dropoff_datetime, ratecode_id, pickup_location_id, dropoff_location_id, passenger_count, trip_distance\n  , count(1) row_count\n  , sum(fare_amount) total_fare_amount\nfrom `pipeline-analysis-452722`.`nytaxi_clean`.`yellow__4_adds_columns`\ngroup by pickup_datetime, dropoff_datetime, ratecode_id, pickup_location_id, dropoff_location_id, passenger_count, trip_distance", "relation_name": "`pipeline-analysis-452722`.`nytaxi_stage2`.`stg_yellow__1a_id_duplicate_records`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-26T17:36:05.283396Z", "completed_at": "2025-03-26T17:36:05.298046Z"}, {"name": "execute", "started_at": "2025-03-26T17:36:05.311159Z", "completed_at": "2025-03-26T17:36:06.822647Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.5565121173858643, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "pipeline-analysis-452722", "job_id": "446d120f-2714-48b7-a3bb-fb675e9ea8ec", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.pipeline_analysis_transform.stg_yellow__1b_id_faulty_trips", "compiled": true, "compiled_code": "\n\nselect data_source, trip_id\nfrom `pipeline-analysis-452722`.`nytaxi_clean`.`yellow__4_adds_columns`\nwhere (\n      -- invalid trip timestamps\n      (pickup_datetime >= dropoff_datetime)\n      or \n      -- trip timestamps not inline with source parquet\n      (pickup_datetime < cast(trip_type_start_date as timestamp))\n      or \n      -- trips with unknown pickup or dropoff location\n      (pickup_location_id = 264 or dropoff_location_id = 264)\n      or \n      -- trip with airport fee but location not at airport \n      (coalesce(airport_fee, 0) > 0 and regexp_substr(pickup_location_id||' - '||dropoff_location_id, '138|132') is null)\n      or \n      -- fare amount negative but payment_type not void, dispute or no charge\n      (fare_amount <= 0 and payment_type not in (3, 4, 6) and trip_type_start_date >= '2022-05-01')\n      or \n      -- all trips must report some distance to be valid\n      (trip_distance < 0)\n      or \n      -- trips where charges dont add up\n      (abs(total_amount) - abs(fare_amount+extra_amount+mta_tax+tip_amount+tolls_amount+improvement_surcharge+congestion_surcharge+airport_fee) > 1)\n      or \n      -- trips with non-JFK destination but got the rate charge\n      (coalesce(ratecode_id, 0) in (2, 0) and regexp_substr(pickup_location_id||' - '||dropoff_location_id, '132') is null and trip_type_start_date >= '2022-05-01')\n      or  \n      -- trips with non-Newark destination but got the rate charge\n      (coalesce(ratecode_id, 0) in (3, 0) and regexp_substr(pickup_location_id||' - '||dropoff_location_id, '^1 - | - 1$') is null and trip_type_start_date >= '2022-05-01')\n      or \n      -- trips tip with outer city rate but locations not outside the city\n      (coalesce(ratecode_id, 0) in (4, 0) and regexp_substr(pickup_location_id||' - '||dropoff_location_id, '265') is null and trip_type_start_date >= '2022-05-01')\n      or \n      -- rows that dont have valid passenger count (either 0 or over the legal limit for a single ride)\n      (passenger_count > 6 or passenger_count <= 0)\n      -- all trips with a positive trip amount should have a cc ratecode ID\n      or  \n      (tip_amount > 0 and payment_type != 1 and trip_type_start_date >= '2022-05-01')\n)", "relation_name": "`pipeline-analysis-452722`.`nytaxi_stage2`.`stg_yellow__1b_id_faulty_trips`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-26T17:36:06.838647Z", "completed_at": "2025-03-26T17:36:06.850484Z"}, {"name": "execute", "started_at": "2025-03-26T17:36:06.852946Z", "completed_at": "2025-03-26T17:36:08.679717Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.8452608585357666, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "pipeline-analysis-452722", "job_id": "be927168-c86d-4033-9d37-89333bbb79f2", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.pipeline_analysis_transform.stg_yellow__2_filter_out_faulty", "compiled": true, "compiled_code": "select \n  tbl.trip_id,\n  tbl.vendor_id,\n  tbl.pickup_datetime,\n  tbl.dropoff_datetime,\n  tbl.passenger_count,\n  tbl.trip_distance,\n  tbl.pickup_location_id,\n  tbl.ratecode_id,\n  tbl.store_and_fwd_flag,\n  tbl.dropoff_location_id,\n  tbl.payment_type,\n  tbl.fare_amount,\n  tbl.extra_amount,\n  tbl.mta_tax,\n  tbl.tip_amount,\n  tbl.tolls_amount,\n  tbl.improvement_surcharge,\n  tbl.total_amount,\n  tbl.congestion_surcharge,\n  tbl.airport_fee,\n  tbl.pickup_date,\n  tbl.trip_type,\n  tbl.trip_type_start_date,\n  tbl.trip_type_end_date,\n  tbl.data_source,\n  tbl.creation_dt\nfrom `pipeline-analysis-452722`.`nytaxi_clean`.`yellow__4_adds_columns` tbl\nleft join `pipeline-analysis-452722`.`nytaxi_stage2`.`stg_yellow__1b_id_faulty_trips` ft1 on tbl.data_source = ft1.data_source \n                                                    and tbl.trip_id = ft1.trip_id\nleft join `pipeline-analysis-452722`.`nytaxi_stage2`.`stg_yellow__1a_id_duplicate_records` ft2 on tbl.pickup_datetime = ft2.pickup_datetime\n                                                        and tbl.dropoff_datetime = ft2.dropoff_datetime\n                                                        and coalesce(tbl.ratecode_id, 0) = coalesce(ft2.ratecode_id, 0)\n                                                        and tbl.pickup_location_id = ft2.pickup_location_id \n                                                        and tbl.dropoff_location_id = ft2.dropoff_location_id \n                                                        and tbl.passenger_count = ft2.passenger_count\n                                                        and tbl.trip_distance = ft2.trip_distance \n                                                        and ft2.row_count = 2\n                                                        and ft2.total_fare_amount = 0\n                                                        and tbl.fare_amount < 0\nwhere ft1.data_source is null and ft2.pickup_location_id is null", "relation_name": "`pipeline-analysis-452722`.`nytaxi_stage2`.`stg_yellow__2_filter_out_faulty`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-26T17:36:08.695249Z", "completed_at": "2025-03-26T17:36:08.719314Z"}, {"name": "execute", "started_at": "2025-03-26T17:36:08.720644Z", "completed_at": "2025-03-26T17:39:14.095183Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 185.40447115898132, "adapter_response": {"_message": "CREATE TABLE (1.6b rows, 383.3 GiB processed)", "code": "CREATE TABLE", "rows_affected": 1648566991, "bytes_processed": 411590881945, "bytes_billed": 411591245824, "location": "EU", "project_id": "pipeline-analysis-452722", "job_id": "8a603bf9-be73-4811-aab2-7f7a0da4c41b", "slot_ms": 332265773}, "message": "CREATE TABLE (1.6b rows, 383.3 GiB processed)", "failures": null, "unique_id": "model.pipeline_analysis_transform.stg_yellow__3_from_source_clean", "compiled": true, "compiled_code": "\n\nselect \n  -- IDs\n  trip_id,\n  vendor_id,\n  -- time centric dimensions \n  pickup_datetime,\n  dropoff_datetime,\n  trip_type_start_date,\n  trip_type_end_date,\n  pickup_date,\n  -- more time dimensions for later analysis \n  \n\n    datetime_diff(\n        cast(dropoff_datetime as datetime),\n        cast(pickup_datetime as datetime),\n        minute\n    )\n\n   trip_duration_min,\n  extract(year from pickup_datetime) pickup_year,\n  extract(dayofweek from pickup_datetime) pickup_weekday_num,\n  case \n        when extract(dayofweek from pickup_datetime) = 1\n            then 'SUNDAY'\n        when extract(dayofweek from pickup_datetime) = 2\n            then 'MONDAY'\n        when extract(dayofweek from pickup_datetime) = 3\n            then 'TUESDAY'\n        when extract(dayofweek from pickup_datetime) = 4\n            then 'WEDNESDAY'\n        when extract(dayofweek from pickup_datetime) = 5\n            then 'THURSDAY'\n        when extract(dayofweek from pickup_datetime) = 6\n            then 'FRIDAY'\n        when extract(dayofweek from pickup_datetime) = 7\n            then 'SATURDAY'\n    end pickup_weekday_name,\n  extract(week from pickup_datetime) pickup_calender_week_num,\n  extract(month from pickup_datetime) pickup_month,\n  extract(hour from pickup_datetime) pickup_hour,\n  bigfunctions.eu.is_public_holiday(cast(pickup_datetime as date), 'US') pickup_public_holiday,\n  extract(year from dropoff_datetime) dropoff_year,\n  extract(dayofweek from dropoff_datetime) dropoff_weekday_num,\n  case \n        when extract(dayofweek from dropoff_datetime) = 1\n            then 'SUNDAY'\n        when extract(dayofweek from dropoff_datetime) = 2\n            then 'MONDAY'\n        when extract(dayofweek from dropoff_datetime) = 3\n            then 'TUESDAY'\n        when extract(dayofweek from dropoff_datetime) = 4\n            then 'WEDNESDAY'\n        when extract(dayofweek from dropoff_datetime) = 5\n            then 'THURSDAY'\n        when extract(dayofweek from dropoff_datetime) = 6\n            then 'FRIDAY'\n        when extract(dayofweek from dropoff_datetime) = 7\n            then 'SATURDAY'\n    end dropoff_weekday_name,\n  extract(week from dropoff_datetime) dropoff_calender_week_num,\n  extract(month from dropoff_datetime) dropoff_month,\n  extract(hour from dropoff_datetime) dropoff_hour,\n  bigfunctions.eu.is_public_holiday(cast(dropoff_datetime as date), 'US') dropoff_public_holiday,\n  -- location centric info \n  pickup_location_id,\n  dropoff_location_id,\n  -- trip categorization\n  ratecode_id,\n  store_and_fwd_flag,\n  payment_type,\n  -- for unit centric calculations\n  passenger_count,\n  trip_distance,\n  -- revenue centric stats\n  fare_amount,\n  extra_amount,\n  mta_tax,\n  tip_amount,\n  tolls_amount,\n  improvement_surcharge,\n  total_amount,\n  congestion_surcharge,\n  airport_fee,\n  -- data source centric info\n  trip_type,\n  data_source,\n  creation_dt,\n  current_timestamp() transformation_dt\nfrom `pipeline-analysis-452722`.`nytaxi_stage2`.`stg_yellow__2_filter_out_faulty`", "relation_name": "`pipeline-analysis-452722`.`nytaxi_stage2`.`stg_yellow__3_from_source_clean`", "batch_results": null}], "elapsed_time": 223.65726804733276, "args": {"log_level_file": "debug", "log_file_max_bytes": 10485760, "defer": false, "warn_error_options": {"include": [], "exclude": []}, "export_saved_queries": false, "include_saved_query": false, "log_level": "info", "send_anonymous_usage_stats": true, "state_modified_compare_vars": false, "which": "build", "exclude_resource_types": [], "empty": false, "favor_state": false, "use_colors_file": true, "show": false, "source_freshness_run_project_hooks": false, "log_path": "/workspaces/pipeline-performance-analysis/2_transformation_dbt/logs", "require_nested_cumulative_type_params": false, "printer_width": 80, "cache_selected_only": false, "macro_debugging": false, "populate_cache": true, "state_modified_compare_more_unrendered_values": false, "partial_parse_file_diff": true, "use_colors": true, "indirect_selection": "eager", "exclude": [], "static_parser": true, "require_yaml_configuration_for_mf_time_spines": false, "profiles_dir": "/workspaces/pipeline-performance-analysis/2_transformation_dbt", "require_batched_execution_for_custom_microbatch_strategy": false, "show_resource_report": false, "version_check": true, "require_resource_names_without_spaces": false, "log_format_file": "debug", "invocation_command": "dbt build", "vars": {}, "project_dir": "/workspaces/pipeline-performance-analysis/2_transformation_dbt", "print": true, "skip_nodes_if_on_run_start_fails": false, "introspect": true, "quiet": false, "partial_parse": true, "resource_types": [], "require_explicit_package_overrides_for_builtin_materializations": true, "log_format": "default", "write_json": true, "select": [], "strict_mode": false}}