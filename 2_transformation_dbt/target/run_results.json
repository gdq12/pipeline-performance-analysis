{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.3", "generated_at": "2025-03-25T19:25:47.513232Z", "invocation_id": "c0092e71-b83d-4ecb-b02e-d2ee66c28185", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-25T19:25:45.633978Z", "completed_at": "2025-03-25T19:25:45.769246Z"}, {"name": "execute", "started_at": "2025-03-25T19:25:45.770613Z", "completed_at": "2025-03-25T19:25:47.496211Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.8649940490722656, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "pipeline-analysis-452722", "job_id": "ff0fd489-34ba-482b-9434-e7c055a25b1a", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.pipeline_analysis_transform.yellow__3_data_type_cast", "compiled": true, "compiled_code": "with trps as \n(select \n    case safe_cast(vendor_id as string)\n        when '1' then 1\n        when '2' then 2\n        when '3' then 3\n        when '4' then 4\n        when '5' then 5\n        when '6' then 6\n        when '7' then 7\n        when 'CMT' then 1\n        when 'VTS' then 8\n        when 'DDS' then 9\n        else null\n    end vendor_id\n    ,cast(pickup_datetime as timestamp) pickup_datetime \n    ,cast(dropoff_datetime as timestamp) dropoff_datetime\n    ,safe_cast(passenger_count as INT64) passenger_count\n    ,cast(trip_distance as float64) trip_distance\n    ,safe_cast(pickup_location_id as INT64) pickup_location_id\n    ,case safe_cast(ratecode_id as string)\n        when '1' then 1\n        when '1.0' then 1\n        when '2' then 2\n        when '2.0' then 2\n        when '3' then 3\n        when '3.0' then 3\n        when '4' then 4\n        when '4.0' then 4\n        when '5' then 5\n        when '5.0' then 5\n        when '6' then 6\n        when '6.0' then 6\n        else null\n    end ratecode_id\n    ,case \n        when trim(safe_cast(store_and_fwd_flag as string))\n            in ('0', '0.0', 'N') then 'N'\n        when trim(safe_cast(store_and_fwd_flag as string))\n            in ('1', '1.0', 'Y') then 'Y'\n        else null \n    end  store_and_fwd_flag\n    ,safe_cast(dropoff_location_id as INT64) dropoff_location_id\n    ,case \n        when lower(trim(safe_cast(payment_type as string))) \n            in ('cash', 'csh', 'cas') then 2\n        when lower(trim(safe_cast(payment_type as string))) \n            in ('credit', 'cre', 'crd') then 1\n        when lower(trim(safe_cast(payment_type as string))) \n            in ('dispute', 'dis') then 4\n        when lower(trim(safe_cast(payment_type as string)))\n            in ('no', 'no charge', 'noc') then 3\n        when lower(trim(safe_cast(payment_type as string)))\n            in ('na', '0') then 5\n        when lower(trim(safe_cast(payment_type as string)))\n            in ('6', '6.0', 'void', 'voi') then 6\n        else 5\n    end payment_type\n    ,cast(fare_amount as float64) fare_amount\n    ,cast(null as float64) extra_amount\n    ,cast(mta_tax as float64) mta_tax\n    ,cast(tip_amount as float64) tip_amount\n    ,cast(tolls_amount as float64) tolls_amount\n    ,cast(null as float64) improvement_surcharge\n    ,cast(total_amount as float64) total_amount\n    ,cast(congestion_surcharge as float64) congestion_surcharge\n    , cast(null as float64) airport_fee\n    ,cast(pickup_date as timestamp) pickup_date\n    ,safe_cast(data_source as string) data_source\n    ,cast(creation_dt as timestamp) creation_dt\nfrom `pipeline-analysis-452722`.`nytaxi_clean`.`yellow__2b_2009_2010_location_id_update`\nunion all \nselect \n    case safe_cast(vendor_id as string)\n        when '1' then 1\n        when '2' then 2\n        when '3' then 3\n        when '4' then 4\n        when '5' then 5\n        when '6' then 6\n        when '7' then 7\n        when 'CMT' then 1\n        when 'VTS' then 8\n        when 'DDS' then 9\n        else null\n    end vendor_id\n    ,cast(pickup_datetime as timestamp) pickup_datetime \n    ,cast(dropoff_datetime as timestamp) dropoff_datetime\n    ,safe_cast(passenger_count as INT64) passenger_count\n    ,cast(trip_distance as float64) trip_distance\n    ,safe_cast(pickup_location_id as INT64) pickup_location_id\n    ,case safe_cast(ratecode_id as string)\n        when '1' then 1\n        when '1.0' then 1\n        when '2' then 2\n        when '2.0' then 2\n        when '3' then 3\n        when '3.0' then 3\n        when '4' then 4\n        when '4.0' then 4\n        when '5' then 5\n        when '5.0' then 5\n        when '6' then 6\n        when '6.0' then 6\n        else null\n    end ratecode_id\n    ,case \n        when trim(safe_cast(store_and_fwd_flag as string))\n            in ('0', '0.0', 'N') then 'N'\n        when trim(safe_cast(store_and_fwd_flag as string))\n            in ('1', '1.0', 'Y') then 'Y'\n        else null \n    end  store_and_fwd_flag\n    ,safe_cast(dropoff_location_id as INT64) dropoff_location_id\n    ,case \n        when lower(trim(safe_cast(payment_type as string))) \n            in ('cash', 'csh', 'cas') then 2\n        when lower(trim(safe_cast(payment_type as string))) \n            in ('credit', 'cre', 'crd') then 1\n        when lower(trim(safe_cast(payment_type as string))) \n            in ('dispute', 'dis') then 4\n        when lower(trim(safe_cast(payment_type as string)))\n            in ('no', 'no charge', 'noc') then 3\n        when lower(trim(safe_cast(payment_type as string)))\n            in ('na', '0') then 5\n        when lower(trim(safe_cast(payment_type as string)))\n            in ('6', '6.0', 'void', 'voi') then 6\n        else 5\n    end payment_type\n    ,cast(fare_amount as float64) fare_amount\n    ,cast(extra_amount as float64) extra_amount\n    ,cast(mta_tax as float64) mta_tax\n    ,cast(tip_amount as float64) tip_amount\n    ,cast(tolls_amount as float64) tolls_amount\n    ,cast(improvement_surcharge as float64) improvement_surcharge\n    ,cast(total_amount as float64) total_amount\n    ,cast(congestion_surcharge as float64) congestion_surcharge\n    ,cast(airport_fee as float64) airport_fee\n    ,cast(pickup_date as timestamp) pickup_date\n    ,safe_cast(data_source as string) data_source\n    ,cast(creation_dt as timestamp) creation_dt\nfrom `pipeline-analysis-452722`.`nytaxi_clean`.`yellow__2_post_2010_tbl_collation`\n)\nselect \n  vendor_id,\n  pickup_datetime,\n  dropoff_datetime,\n  passenger_count,\n  trip_distance,\n  pickup_location_id,\n  ratecode_id,\n  store_and_fwd_flag,\n  dropoff_location_id,\n  payment_type,\n  fare_amount,\n  extra_amount,\n  mta_tax,\n  tip_amount,\n  tolls_amount,\n  improvement_surcharge,\n  total_amount,\n  congestion_surcharge,\n  airport_fee,\n  pickup_date,\n  data_source,\n  creation_dt\nfrom trps", "relation_name": "`pipeline-analysis-452722`.`nytaxi_clean`.`yellow__3_data_type_cast`", "batch_results": null}], "elapsed_time": 2.8249969482421875, "args": {"use_colors": true, "include_saved_query": false, "partial_parse_file_diff": true, "require_yaml_configuration_for_mf_time_spines": false, "require_resource_names_without_spaces": false, "source_freshness_run_project_hooks": false, "strict_mode": false, "export_saved_queries": false, "profiles_dir": "/workspaces/pipeline-performance-analysis/2_transformation_dbt", "exclude_resource_types": [], "empty": false, "select": ["yellow__3_data_type_cast"], "log_level": "info", "macro_debugging": false, "which": "build", "warn_error_options": {"include": [], "exclude": []}, "write_json": true, "exclude": [], "state_modified_compare_more_unrendered_values": false, "version_check": true, "populate_cache": true, "skip_nodes_if_on_run_start_fails": false, "log_level_file": "debug", "require_batched_execution_for_custom_microbatch_strategy": false, "require_explicit_package_overrides_for_builtin_materializations": true, "static_parser": true, "require_nested_cumulative_type_params": false, "partial_parse": true, "show": false, "favor_state": false, "log_path": "/workspaces/pipeline-performance-analysis/2_transformation_dbt/logs", "resource_types": [], "use_colors_file": true, "print": true, "vars": {}, "cache_selected_only": false, "log_file_max_bytes": 10485760, "invocation_command": "dbt build --select yellow__3_data_type_cast", "introspect": true, "state_modified_compare_vars": false, "defer": false, "indirect_selection": "eager", "send_anonymous_usage_stats": true, "project_dir": "/workspaces/pipeline-performance-analysis/2_transformation_dbt", "quiet": false, "show_resource_report": false, "log_format_file": "debug", "log_format": "default", "printer_width": 80}}