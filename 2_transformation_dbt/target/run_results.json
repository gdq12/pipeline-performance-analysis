{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.3", "generated_at": "2025-03-25T03:21:22.642834Z", "invocation_id": "fc2abc05-a397-481b-82a5-7cc991653426", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-25T03:20:55.729850Z", "completed_at": "2025-03-25T03:20:55.746704Z"}, {"name": "execute", "started_at": "2025-03-25T03:20:55.748979Z", "completed_at": "2025-03-25T03:20:56.511477Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.7841808795928955, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "pipeline-analysis-452722", "job_id": "013f7a75-73df-4855-81e7-bf2ebe4e1cf4", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.pipeline_analysis_transform.yellow__1_column_name_mapping", "compiled": true, "compiled_code": "select \n  table_name\n  , column_name old_column_name\n  , case\n      when column_name in ('start_lon', 'pickup_longitude') then 'pickup_longitude'\n      when column_name in ('start_lat', 'pickup_latitude') then 'pickup_latitude'\n      when column_name in ('end_lon', 'dropoff_longitude') then 'dropoff_longitude'\n      when column_name in ('end_lat', 'dropoff_latitude') then 'dropoff_latitude'\n      when column_name = 'store_and_forward' then 'store_and_fwd_flag'\n      when column_name = 'vendor_name' then 'vendor_id'\n      when column_name = 'rate_code' then 'ratecode_id'\n      when column_name = 'extra' then 'extra_amount'\n      when column_name = 'surcharge' then 'congestion_surcharge'\n      when regexp_substr(column_name, 'do_') is not null then regexp_replace(column_name, 'do_', 'dropoff_')\n      when regexp_substr(column_name, 'pu_') is not null then regexp_replace(column_name, 'pu_', 'pickup_')\n      when regexp_substr(column_name, 'amt') is not null then regexp_replace(column_name, 'amt', 'amount')\n      when regexp_substr(column_name, 'tpep') is not null then regexp_replace(column_name, 'tpep_', '')\n      when regexp_substr(column_name, 'trip_') is not null \n        and regexp_substr(column_name, 'date') is not null \n        then regexp_replace(regexp_replace(column_name, 'trip_', ''), 'date_time$', 'datetime')\n      else column_name end new_column_name\n  , data_type\n  , ordinal_position\nfrom `pipeline-analysis-452722`.`nytaxi_stage`.`INFORMATION_SCHEMA.COLUMNS`\nwhere column_name != '__index_level_0__'\nand regexp_substr(table_name, 'yellow_tripdata') is not null", "relation_name": "`pipeline-analysis-452722`.`nytaxi_clean`.`yellow__1_column_name_mapping`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-25T03:20:56.540207Z", "completed_at": "2025-03-25T03:21:01.568489Z"}, {"name": "execute", "started_at": "2025-03-25T03:21:01.569877Z", "completed_at": "2025-03-25T03:21:02.084647Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 5.560139179229736, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "pipeline-analysis-452722", "job_id": "08ddb97e-274f-49e7-8912-bdfe0e9c02c8", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.pipeline_analysis_transform.yellow__2a_2009_2010_tbl_collation", "compiled": true, "compiled_code": "with trps as \n(\n\n\n\n\n\n  \n\n  \n\n  select \n    \n          \n            surcharge as congestion_surcharge\n          \n        , \n          \n            creation_dt as creation_dt\n          \n        , \n          \n            data_source as data_source\n          \n        , \n          \n            trip_dropoff_date_time as dropoff_datetime\n          \n        , \n          \n            end_lat as dropoff_latitude\n          \n        , \n          \n            end_lon as dropoff_longitude\n          \n        , \n          \n            fare_amt as fare_amount\n          \n        , \n          \n            mta_tax as mta_tax\n          \n        , \n          \n            passenger_count as passenger_count\n          \n        , \n          \n            payment_type as payment_type\n          \n        , \n          \n            trip_pickup_date as pickup_date\n          \n        , \n          \n            trip_pickup_date_time as pickup_datetime\n          \n        , \n          \n            start_lat as pickup_latitude\n          \n        , \n          \n            start_lon as pickup_longitude\n          \n        , \n          \n            safe_cast(rate_code as INT64) as ratecode_id\n          \n        , \n          \n            safe_cast(store_and_forward as string) as store_and_fwd_flag\n          \n        , \n          \n            tip_amt as tip_amount\n          \n        , \n          \n            tolls_amt as tolls_amount\n          \n        , \n          \n            total_amt as total_amount\n          \n        , \n          \n            trip_distance as trip_distance\n          \n        , \n          \n            vendor_name as vendor_id\n          \n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2009-01`\n    union all \n\n  \n\n  \n\n  select \n    \n          \n            surcharge as congestion_surcharge\n          \n        , \n          \n            creation_dt as creation_dt\n          \n        , \n          \n            data_source as data_source\n          \n        , \n          \n            dropoff_datetime as dropoff_datetime\n          \n        , \n          \n            dropoff_latitude as dropoff_latitude\n          \n        , \n          \n            dropoff_longitude as dropoff_longitude\n          \n        , \n          \n            fare_amount as fare_amount\n          \n        , \n          \n            mta_tax as mta_tax\n          \n        , \n          \n            passenger_count as passenger_count\n          \n        , \n          \n            payment_type as payment_type\n          \n        , \n          \n            pickup_date as pickup_date\n          \n        , \n          \n            pickup_datetime as pickup_datetime\n          \n        , \n          \n            pickup_latitude as pickup_latitude\n          \n        , \n          \n            pickup_longitude as pickup_longitude\n          \n        , \n          \n            safe_cast(rate_code as INT64) as ratecode_id\n          \n        , \n          \n            safe_cast(store_and_fwd_flag as string) as store_and_fwd_flag\n          \n        , \n          \n            tip_amount as tip_amount\n          \n        , \n          \n            tolls_amount as tolls_amount\n          \n        , \n          \n            total_amount as total_amount\n          \n        , \n          \n            trip_distance as trip_distance\n          \n        , \n          \n            vendor_id as vendor_id\n          \n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2010-01`\n    union all \n\n  \n\n  \n\n  select \n    \n          \n            surcharge as congestion_surcharge\n          \n        , \n          \n            creation_dt as creation_dt\n          \n        , \n          \n            data_source as data_source\n          \n        , \n          \n            dropoff_datetime as dropoff_datetime\n          \n        , \n          \n            dropoff_latitude as dropoff_latitude\n          \n        , \n          \n            dropoff_longitude as dropoff_longitude\n          \n        , \n          \n            fare_amount as fare_amount\n          \n        , \n          \n            mta_tax as mta_tax\n          \n        , \n          \n            passenger_count as passenger_count\n          \n        , \n          \n            payment_type as payment_type\n          \n        , \n          \n            pickup_date as pickup_date\n          \n        , \n          \n            pickup_datetime as pickup_datetime\n          \n        , \n          \n            pickup_latitude as pickup_latitude\n          \n        , \n          \n            pickup_longitude as pickup_longitude\n          \n        , \n          \n            safe_cast(rate_code as INT64) as ratecode_id\n          \n        , \n          \n            safe_cast(store_and_fwd_flag as string) as store_and_fwd_flag\n          \n        , \n          \n            tip_amount as tip_amount\n          \n        , \n          \n            tolls_amount as tolls_amount\n          \n        , \n          \n            total_amount as total_amount\n          \n        , \n          \n            trip_distance as trip_distance\n          \n        , \n          \n            vendor_id as vendor_id\n          \n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2010-02`\n    union all \n\n  \n\n  \n\n  select \n    \n          \n            surcharge as congestion_surcharge\n          \n        , \n          \n            creation_dt as creation_dt\n          \n        , \n          \n            data_source as data_source\n          \n        , \n          \n            dropoff_datetime as dropoff_datetime\n          \n        , \n          \n            dropoff_latitude as dropoff_latitude\n          \n        , \n          \n            dropoff_longitude as dropoff_longitude\n          \n        , \n          \n            fare_amount as fare_amount\n          \n        , \n          \n            mta_tax as mta_tax\n          \n        , \n          \n            passenger_count as passenger_count\n          \n        , \n          \n            payment_type as payment_type\n          \n        , \n          \n            pickup_date as pickup_date\n          \n        , \n          \n            pickup_datetime as pickup_datetime\n          \n        , \n          \n            pickup_latitude as pickup_latitude\n          \n        , \n          \n            pickup_longitude as pickup_longitude\n          \n        , \n          \n            safe_cast(rate_code as INT64) as ratecode_id\n          \n        , \n          \n            safe_cast(store_and_fwd_flag as string) as store_and_fwd_flag\n          \n        , \n          \n            tip_amount as tip_amount\n          \n        , \n          \n            tolls_amount as tolls_amount\n          \n        , \n          \n            total_amount as total_amount\n          \n        , \n          \n            trip_distance as trip_distance\n          \n        , \n          \n            vendor_id as vendor_id\n          \n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2010-04`\n    \n)\nselect \n  vendor_id,\n  pickup_datetime,\n  dropoff_datetime,\n  passenger_count,\n  trip_distance,\n  pickup_longitude, \n  pickup_latitude,\n  ratecode_id,\n  store_and_fwd_flag,\n  dropoff_longitude, \n  dropoff_latitude,\n  payment_type,\n  fare_amount,\n  mta_tax,\n  tip_amount,\n  tolls_amount,\n  total_amount,\n  congestion_surcharge,\n  pickup_date,\n  data_source,\n  creation_dt\nfrom trps", "relation_name": "`pipeline-analysis-452722`.`nytaxi_clean`.`yellow__2a_2009_2010_tbl_collation`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-25T03:21:02.107103Z", "completed_at": "2025-03-25T03:21:02.119379Z"}, {"name": "execute", "started_at": "2025-03-25T03:21:02.120712Z", "completed_at": "2025-03-25T03:21:03.174828Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0716068744659424, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "pipeline-analysis-452722", "job_id": "815647bf-3608-424b-b678-e22bb4776381", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.pipeline_analysis_transform.yellow__2b_2009_2010_location_id_update", "compiled": true, "compiled_code": "select \n  trp.vendor_id,\n  trp.pickup_datetime,\n  trp.dropoff_datetime,\n  trp.passenger_count,\n  trp.trip_distance,\n  pu.zone_id pickup_location_id,\n  trp.ratecode_id,\n  trp.store_and_fwd_flag,\n  du.zone_id dropoff_location_id,\n  trp.payment_type,\n  trp.fare_amount,\n  trp.mta_tax,\n  trp.tip_amount,\n  trp.tolls_amount,\n  trp.total_amount,\n  trp.congestion_surcharge,\n  trp.pickup_date,\n  trp.data_source,\n  trp.creation_dt\nfrom `pipeline-analysis-452722`.`nytaxi_clean`.`yellow__2a_2009_2010_tbl_collation` trp\njoin `pipeline-analysis-452722`.`mapping`.`taxi_zone_geom` pu on (ST_DWithin(pu.zone_geom,ST_GeogPoint(trp.pickup_longitude, trp.pickup_latitude), 0))\njoin `pipeline-analysis-452722`.`mapping`.`taxi_zone_geom` du on (ST_DWithin(du.zone_geom,ST_GeogPoint(trp.dropoff_longitude, trp.dropoff_latitude), 0))\nwhere trp.pickup_longitude between -180 and 180\nand trp.pickup_latitude between -90 and 90\nand trp.dropoff_longitude between -180 and 180\nand trp.dropoff_latitude between -90 and 90", "relation_name": "`pipeline-analysis-452722`.`nytaxi_clean`.`yellow__2b_2009_2010_location_id_update`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-25T03:20:56.528837Z", "completed_at": "2025-03-25T03:21:19.711739Z"}, {"name": "execute", "started_at": "2025-03-25T03:21:19.713288Z", "completed_at": "2025-03-25T03:21:20.241252Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 23.717994451522827, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "pipeline-analysis-452722", "job_id": "8551de4f-75b3-4ff6-be37-279dfbc529fb", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.pipeline_analysis_transform.yellow__2_post_2010_tbl_collation", "compiled": true, "compiled_code": "with trps as \n(\n\n\n\n\n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2011-01`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2011-02`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2011-03`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2011-04`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2012-12`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2013-01`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2013-05`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2013-06`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2014-01`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2014-02`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2014-08`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2014-09`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2018-01`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2018-02`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2018-06`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2018-07`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2018-09`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2018-10`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2018-11`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2018-12`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2019-01`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2020-08`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2020-10`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2020-11`\n    union all \n\n  \n\n  \n\n  select \n    \n      airport_fee as airport_fee\n        , \n      congestion_surcharge as congestion_surcharge\n        , \n      creation_dt as creation_dt\n        , \n      data_source as data_source\n        , \n      tpep_dropoff_datetime as dropoff_datetime\n        , \n      do_location_id as dropoff_location_id\n        , \n      extra as extra_amount\n        , \n      fare_amount as fare_amount\n        , \n      improvement_surcharge as improvement_surcharge\n        , \n      mta_tax as mta_tax\n        , \n      passenger_count as passenger_count\n        , \n      payment_type as payment_type\n        , \n      tpep_pickup_date as pickup_date\n        , \n      tpep_pickup_datetime as pickup_datetime\n        , \n      pu_location_id as pickup_location_id\n        , \n      ratecode_id as ratecode_id\n        , \n      store_and_fwd_flag as store_and_fwd_flag\n        , \n      tip_amount as tip_amount\n        , \n      tolls_amount as tolls_amount\n        , \n      total_amount as total_amount\n        , \n      trip_distance as trip_distance\n        , \n      vendor_id as vendor_id\n        \n  from `pipeline-analysis-452722`.`nytaxi_stage`.`yellow_tripdata_2023-02`\n    \n)\nselect \n  vendor_id,\n  pickup_datetime,\n  dropoff_datetime,\n  passenger_count,\n  trip_distance,\n  pickup_location_id,\n  ratecode_id,\n  store_and_fwd_flag,\n  dropoff_location_id,\n  payment_type,\n  fare_amount,\n  extra_amount,\n  mta_tax,\n  tip_amount,\n  tolls_amount,\n  improvement_surcharge,\n  total_amount,\n  congestion_surcharge,\n  airport_fee,\n  pickup_date,\n  data_source,\n  creation_dt\nfrom trps", "relation_name": "`pipeline-analysis-452722`.`nytaxi_clean`.`yellow__2_post_2010_tbl_collation`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-25T03:21:20.254924Z", "completed_at": "2025-03-25T03:21:20.284091Z"}, {"name": "execute", "started_at": "2025-03-25T03:21:20.285006Z", "completed_at": "2025-03-25T03:21:21.380088Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.1280081272125244, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "pipeline-analysis-452722", "job_id": "c9cc74f7-77e8-4f22-a4f0-a296f80d6ae3", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.pipeline_analysis_transform.yellow__3_data_type_cast", "compiled": true, "compiled_code": "with trps as \n(select \n    case safe_cast(vendor_id as string)\n        when '1' then 1\n        when '2' then 2\n        when '3' then 3\n        when '4' then 4\n        when '5' then 5\n        when '6' then 6\n        when '7' then 7\n        when 'CMT' then 1\n        when 'VTS' then 8\n        when 'DDS' then 9\n        else null\n    end vendor_id\n    ,cast(pickup_datetime as timestamp) pickup_datetime \n    ,cast(dropoff_datetime as timestamp) dropoff_datetime\n    ,safe_cast(passenger_count as INT64) passenger_count\n    ,cast(trip_distance as float64) trip_distance\n    ,safe_cast(pickup_location_id as INT64) pickup_location_id\n    ,case safe_cast(ratecode_id as string)\n        when '1' then 1\n        when '1.0' then 1\n        when '2' then 2\n        when '2.0' then 2\n        when '3' then 3\n        when '3.0' then 3\n        when '4' then 4\n        when '4.0' then 4\n        when '5' then 5\n        when '5.0' then 5\n        when '6' then 6\n        when '6.0' then 6\n        else null\n    end ratecode_id\n    ,case \n        when trim(safe_cast(store_and_fwd_flag as string))\n            in ('0', '0.0', 'N') then 'N'\n        when trim(safe_cast(store_and_fwd_flag as string))\n            in ('1', '1.0', 'Y') then 'Y'\n        else null \n    end  store_and_fwd_flag\n    ,safe_cast(dropoff_location_id as INT64) dropoff_location_id\n    ,case \n        when lower(trim(safe_cast(payment_type as string))) \n            in ('cash', 'csh', 'cas') then 2\n        when lower(trim(safe_cast(payment_type as string))) \n            in ('credit', 'cre', 'crd') then 1\n        when lower(trim(safe_cast(payment_type as string))) \n            in ('dispute', 'dis') then 4\n        when lower(trim(safe_cast(payment_type as string)))\n            in ('no', 'no charge', 'noc') then 3\n        when lower(trim(safe_cast(payment_type as string)))\n            in ('na', '0') then 5\n        else null \n    end payment_type\n    ,cast(fare_amount as float64) fare_amount\n    ,cast(null as float64) extra_amount\n    ,cast(mta_tax as float64) mta_tax\n    ,cast(tip_amount as float64) tip_amount\n    ,cast(tolls_amount as float64) tolls_amount\n    ,cast(null as float64) improvement_surcharge\n    ,cast(total_amount as float64) total_amount\n    ,cast(congestion_surcharge as float64) congestion_surcharge\n    , cast(null as float64) airport_fee\n    ,cast(pickup_date as timestamp) pickup_date\n    ,safe_cast(data_source as string) data_source\n    ,cast(creation_dt as timestamp) creation_dt\nfrom `pipeline-analysis-452722`.`nytaxi_clean`.`yellow__2b_2009_2010_location_id_update`\nunion all \nselect \n    case safe_cast(vendor_id as string)\n        when '1' then 1\n        when '2' then 2\n        when '3' then 3\n        when '4' then 4\n        when '5' then 5\n        when '6' then 6\n        when '7' then 7\n        when 'CMT' then 1\n        when 'VTS' then 8\n        when 'DDS' then 9\n        else null\n    end vendor_id\n    ,cast(pickup_datetime as timestamp) pickup_datetime \n    ,cast(dropoff_datetime as timestamp) dropoff_datetime\n    ,safe_cast(passenger_count as INT64) passenger_count\n    ,cast(trip_distance as float64) trip_distance\n    ,safe_cast(pickup_location_id as INT64) pickup_location_id\n    ,case safe_cast(ratecode_id as string)\n        when '1' then 1\n        when '1.0' then 1\n        when '2' then 2\n        when '2.0' then 2\n        when '3' then 3\n        when '3.0' then 3\n        when '4' then 4\n        when '4.0' then 4\n        when '5' then 5\n        when '5.0' then 5\n        when '6' then 6\n        when '6.0' then 6\n        else null\n    end ratecode_id\n    ,case \n        when trim(safe_cast(store_and_fwd_flag as string))\n            in ('0', '0.0', 'N') then 'N'\n        when trim(safe_cast(store_and_fwd_flag as string))\n            in ('1', '1.0', 'Y') then 'Y'\n        else null \n    end  store_and_fwd_flag\n    ,safe_cast(dropoff_location_id as INT64) dropoff_location_id\n    ,case \n        when lower(trim(safe_cast(payment_type as string))) \n            in ('cash', 'csh', 'cas') then 2\n        when lower(trim(safe_cast(payment_type as string))) \n            in ('credit', 'cre', 'crd') then 1\n        when lower(trim(safe_cast(payment_type as string))) \n            in ('dispute', 'dis') then 4\n        when lower(trim(safe_cast(payment_type as string)))\n            in ('no', 'no charge', 'noc') then 3\n        when lower(trim(safe_cast(payment_type as string)))\n            in ('na', '0') then 5\n        else null \n    end payment_type\n    ,cast(fare_amount as float64) fare_amount\n    ,cast(extra_amount as float64) extra_amount\n    ,cast(mta_tax as float64) mta_tax\n    ,cast(tip_amount as float64) tip_amount\n    ,cast(tolls_amount as float64) tolls_amount\n    ,cast(improvement_surcharge as float64) improvement_surcharge\n    ,cast(total_amount as float64) total_amount\n    ,cast(congestion_surcharge as float64) congestion_surcharge\n    ,cast(airport_fee as float64) airport_fee\n    ,cast(pickup_date as timestamp) pickup_date\n    ,safe_cast(data_source as string) data_source\n    ,cast(creation_dt as timestamp) creation_dt\nfrom `pipeline-analysis-452722`.`nytaxi_clean`.`yellow__2_post_2010_tbl_collation`\n)\nselect \n  vendor_id,\n  pickup_datetime,\n  dropoff_datetime,\n  passenger_count,\n  trip_distance,\n  pickup_location_id,\n  ratecode_id,\n  store_and_fwd_flag,\n  dropoff_location_id,\n  payment_type,\n  fare_amount,\n  extra_amount,\n  mta_tax,\n  tip_amount,\n  tolls_amount,\n  improvement_surcharge,\n  total_amount,\n  congestion_surcharge,\n  airport_fee,\n  pickup_date,\n  data_source,\n  creation_dt\nfrom trps", "relation_name": "`pipeline-analysis-452722`.`nytaxi_clean`.`yellow__3_data_type_cast`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-25T03:21:21.390902Z", "completed_at": "2025-03-25T03:21:21.403859Z"}, {"name": "execute", "started_at": "2025-03-25T03:21:21.405973Z", "completed_at": "2025-03-25T03:21:22.611394Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.2252750396728516, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "pipeline-analysis-452722", "job_id": "b8394a1e-341c-4ef4-8d03-3e1c1808b681", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.pipeline_analysis_transform.yellow__4_add_columns", "compiled": true, "compiled_code": "select \n  to_hex(md5(cast(coalesce(cast(vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(pickup_datetime  as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(passenger_count as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(trip_distance as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(pickup_location_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(ratecode_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_and_fwd_flag as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_location_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(payment_type as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(fare_amount as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(extra_amount as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(mta_tax as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tip_amount as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tolls_amount as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(improvement_surcharge as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(total_amount as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(congestion_surcharge as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(airport_fee as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data_source as string), '_dbt_utils_surrogate_key_null_') as string))) trip_id,\n  vendor_id,\n  pickup_datetime,\n  dropoff_datetime,\n  passenger_count,\n  trip_distance,\n  pickup_location_id,\n  ratecode_id,\n  store_and_fwd_flag,\n  dropoff_location_id,\n  payment_type,\n  fare_amount,\n  extra_amount,\n  mta_tax,\n  tip_amount,\n  tolls_amount,\n  improvement_surcharge,\n  total_amount,\n  congestion_surcharge,\n  airport_fee,\n  pickup_date,\n  regexp_replace(regexp_substr(data_source, '[a-z]{1,6}_tripdata'), '_tripdata', '') trip_type,\n  parse_datetime('%Y-%m-%d', regexp_substr(data_source, '[0-9]{4}-[0-9]{2}$')||'-01') trip_type_start_date,\n  last_day(parse_date('%Y-%m-%d', regexp_substr(data_source, '[0-9]{4}-[0-9]{2}$')||'-01'), month) trip_type_end_date,\n  data_source,\n  creation_dt\nfrom `pipeline-analysis-452722`.`nytaxi_clean`.`yellow__3_data_type_cast`", "relation_name": "`pipeline-analysis-452722`.`nytaxi_clean`.`yellow__4_add_columns`", "batch_results": null}], "elapsed_time": 29.64051103591919, "args": {"send_anonymous_usage_stats": true, "state_modified_compare_more_unrendered_values": false, "defer": false, "log_format_file": "debug", "partial_parse": true, "empty": false, "indirect_selection": "eager", "partial_parse_file_diff": true, "require_resource_names_without_spaces": false, "invocation_command": "dbt run", "log_format": "default", "profiles_dir": "/workspaces/pipeline-performance-analysis/2_transformation_dbt", "require_explicit_package_overrides_for_builtin_materializations": true, "require_yaml_configuration_for_mf_time_spines": false, "which": "run", "log_level": "info", "macro_debugging": false, "project_dir": "/workspaces/pipeline-performance-analysis/2_transformation_dbt", "introspect": true, "static_parser": true, "print": true, "vars": {}, "warn_error_options": {"include": [], "exclude": []}, "log_path": "/workspaces/pipeline-performance-analysis/2_transformation_dbt/logs", "printer_width": 80, "skip_nodes_if_on_run_start_fails": false, "state_modified_compare_vars": false, "strict_mode": false, "source_freshness_run_project_hooks": false, "log_file_max_bytes": 10485760, "write_json": true, "populate_cache": true, "cache_selected_only": false, "use_colors": true, "log_level_file": "debug", "exclude": [], "favor_state": false, "quiet": false, "require_nested_cumulative_type_params": false, "require_batched_execution_for_custom_microbatch_strategy": false, "select": [], "version_check": true, "show_resource_report": false, "use_colors_file": true}}